%%
%% This is file `sidenotes.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% sidenotes.dtx  (with options: `package')
%% 
%% IMPORTANT NOTE:
%% 
%% This is a generated file and you are not allowed to distribute it
%% without the source of the work.  See below about more informations
%% about the files the work consists of.
%% 
\ProvidesPackage{sidenotes}[%
  2014/05/29 v0.97b rich text in the margin for LaTeX]
\RequirePackage{marginnote} % provides an offset option for the marginals instead of a float
\RequirePackage{caption} % handles the captions (in the margin)
\RequirePackage{xparse} % new LaTeX3 syntax to define macros and environments
\RequirePackage[strict]{changepage} % Changepage package for symmetric twoside handling
\newcounter{sidenote} % make a counter
\setcounter{sidenote}{1} % init the counter
\ExplSyntaxOn
\DeclareExpandableDocumentCommand{\IfNoValueOrEmptyTF}{mmm}
{
 \IfNoValueTF{#1}
  {#2} % true
  {\tl_if_empty:nTF {#1} {#2} {#3}} % false
}
\ExplSyntaxOff
\NewDocumentCommand \@sidenotes@multisign { } {3sp}
\NewDocumentCommand \@sidenotes@multimarker { } {%
\kern-\@sidenotes@multisign%
\kern\@sidenotes@multisign\relax%
}
\ExplSyntaxOn
\NewDocumentCommand \@sidenotes@multichecker { }
{ \dim_compare:nNnTF \lastkern = \@sidenotes@multisign
  {\textsuperscript{,}}
  {}
}
\ExplSyntaxOff
\NewDocumentCommand \@sidenotes@placemarginal { m m } {%
\IfNoValueOrEmptyTF{#1}%
{\marginpar{#2}}% is empty, use marginpar
{\marginnote{#2}[#1]}}% is not empty, use marginnote
\NewDocumentCommand \sidenote { o o +m } {%
\sidenotemark[#1]%
\sidenotetext[#1][#2]{#3}%
\@sidenotes@multimarker%
}
\NewDocumentCommand \sidenotemark { o } {%
\@sidenotes@multichecker%
\IfNoValueOrEmptyTF{#1}%
{\textsuperscript{\thesidenote}}% if no argument is given use sidenote counter
{\textsuperscript{#1}}% print out the argument otherwise
\@sidenotes@multimarker%
}%
\NewDocumentCommand \sidenotetext { o o +m } {%
\IfNoValueOrEmptyTF{#1}{% sitenotemark given?
\@sidenotes@placemarginal{#2}{\textsuperscript{\thesidenote}{} #3}%
\refstepcounter{sidenote}}%
{\@sidenotes@placemarginal{#2}{\textsuperscript{#1} #3}}%
}%
\DeclareCaptionStyle{sidecaption}{font=footnotesize}
\NewDocumentCommand \sidecaption {s o o m} {%
\captionsetup{style=sidecaption}%
\IfBooleanTF{#1}%is the macro starred
{\IfNoValueOrEmptyTF{#2}%
{\marginnote{\caption*{#4}}}%
{\marginnote{\caption*{#4}}[#2]}%
}% yes, starred macro
{%
\IfNoValueOrEmptyTF{#2}%
{\def\@sidenotes@sidecaption@tof{#4}}%
{\def\@sidenotes@sidecaption@tof{#2}}%
\IfNoValueOrEmptyTF{#3}%
{\marginnote{\caption[\@sidenotes@sidecaption@tof]{#4}}}%
{\marginnote{\caption[\@sidenotes@sidecaption@tof]{#4}}[#3]}%
}% no, unstarred macro
}
\newsavebox{\@sidenotes@marginfigurebox}
\DeclareCaptionStyle{marginfigure}{font=footnotesize}
\NewDocumentEnvironment{marginfigure}{o}
{\begin{lrbox}{\@sidenotes@marginfigurebox}%
\begin{minipage}{\marginparwidth}%
\captionsetup{type=figure,style=marginfigure}}%
{\end{minipage}%
\end{lrbox}%
\@sidenotes@placemarginal{#1}{\usebox{\@sidenotes@marginfigurebox}}}%
\newsavebox{\@sidenotes@margintablebox}
\DeclareCaptionStyle{margintable}{font=footnotesize}
\NewDocumentEnvironment{margintable}{o}
{\begin{lrbox}{\@sidenotes@margintablebox}%
\begin{minipage}{\marginparwidth}%
\captionsetup{type=table,style=margintable}}%
{\end{minipage}%
\end{lrbox}%
\@sidenotes@placemarginal{#1}{\usebox{\@sidenotes@margintablebox}}}%
\AtBeginDocument{%
\newlength{\@sidenotes@extrawidth}
\setlength{\@sidenotes@extrawidth}{\marginparwidth}
\addtolength{\@sidenotes@extrawidth}{\marginparsep}}
\DeclareCaptionStyle{widefigure}{font=footnotesize}
\renewenvironment{figure*}[1][htbp]{%
\begin{figure}[#1]%
    \begin{adjustwidth*}{}{-\@sidenotes@extrawidth}%
    \captionsetup{style=widefigure}}%
{   \end{adjustwidth*}%
    \end{figure}}%
\DeclareCaptionStyle{widetable}{font=footnotesize}
\renewenvironment{table*}[1][htbp]{%
\begin{table}[#1]%
    \begin{adjustwidth*}{}{-\@sidenotes@extrawidth}%
    \captionsetup{style=widetable}}%
{   \end{adjustwidth*}%
    \end{table}}%
\endinput
%%
%% End of file `sidenotes.sty'.
